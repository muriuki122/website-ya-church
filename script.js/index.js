// Language translation data
const translations = {
    en: {
        // Header and Navigation
        "motto": "Growing in faith, serving with love",
        "home": "Home",
        "watch": "Watch Online",
        "about": "About Us",
        "archives": "Archives",
        "contact": "Contact",
        
        // Hero Section
        "welcome": "Welcome to Kaloleni Seventh Day Church",
        "hero-text": "Join us as we worship, learn, and grow together in Yashua",
        "join": "Join Our Service",
        "learn": "Learn More",
        
        // Upcoming Events
        "upcoming": "Upcoming Events",
        "june": "Weekly, sunset Friday to nightfall Saturday.",
        "july": "15–21 Nissan (Spring).",
        "event1-title": "Rest, spiritual renewal, and remembrance of Creation/Exodus.",
        "event1-time": "Saturday, 9:00 AM - 4:00 PM",
        "event1-desc": "Synagogue services (Kabbalat Shabbat, Shacharit, Torah reading).",
        "event2-title": "Eating only unleavened bread (matzah)",
        "event2-time": "7 days.",
        "event2-desc": "This event takes 7 days",
        "event3-title": "All-night Torah study (Tikkun Leil Shavuot).",
        "event3-time": "",
        "event3-desc": "Theme: Receiving the Torah at Mount Sinai.",
        "view-all": "View All Events",
        
        // Watch Online Section
        "watch-title": "Watch Our Services Online",
        "watch-text": "Can't join us in person? Watch our live streams or previous services directly on our website without leaving this page.",
        "live": "Visit Our YouTube Channel",
        
        // Footer
        "newsletter": "Subscribe to receive inspiration and updates",
        "email-placeholder": "Your email address",
        "quick-links": "Quick Links",
        "contact-us": "Contact Us",
        "rights": "All Rights Reserved"
    },
    
    sw: {
        // Header and Navigation
        "motto": "Kukua katika imani, kutumikia kwa upendo",
        "home": "Nyumbani",
        "watch": "Tazama Mtandaoni",
        "about": "Kuhusu Sisi",
        "archives": "Kumbukumbu",
        "contact": "Wasiliana",
        
        // Hero Section
        "welcome": "Karibu Kanisa la Kaloleni la Siku ya Saba",
        "hero-text": "Jiunge nasi tunapoabudu, kujifunza, na kukua pamoja katika Yashua",
        "join": "Jiunge na Ibada Yetu",
        "learn": "Jifunze Zaidi",
        
        // Upcoming Events
        "upcoming": "Matukio Yajayo",
        "june": "Kila wiki, jua linapozama Ijumaa hadi usiku Jumamosi.",
        "july": "15-21 Nissan (Masika).",
        "event1-title": "Kupumzika, ufufuo wa kiroho, na kukumbuka Uumbaji/Kutoroka.",
        "event1-time": "Jumamosi, saa 3:00 asubuhi - saa 10:00 jioni",
        "event1-desc": "Huduma za sinagogi (Kabbalat Shabbat, Shacharit, usomaji wa Torati).",
        "event2-title": "Kula mkate usio na chachu (matzah) pekee",
        "event2-time": "Siku 7.",
        "event2-desc": "Tukio hili huchukua siku 7",
        "event3-title": "Masomo ya Torati usiku kucha (Tikkun Leil Shavuot).",
        "event3-time": "",
        "event3-desc": "Mada: Kupokea Torati kwenye Mlima Sinai.",
        "view-all": "Tazama Matukio Yote",
        
        // Watch Online Section
        "watch-title": "Tazama Huduma Zetu Mtandaoni",
        "watch-text": "Hauwezi kujiunga nasi kibinafsi? Tazama matangazo yetu ya moja kwa moja au huduma zilizopita moja kwa moja kwenye wavuti yetu bila kuacha ukurasa huu.",
        "live": "Tembelea Kituo Chetu cha YouTube",
        
        // Footer
        "newsletter": "Jiandikishe kupokea msukumo na visasisho",
        "email-placeholder": "Anwani yako ya barua pepe",
        "quick-links": "Viungo vya Haraka",
        "contact-us": "Wasiliana Nasi",
        "rights": "Haki Zimehifadhiwa"
    },
    
    rw: {
        // Header and Navigation
        "motto": "Kugwira neza mu kwizera, gukorera hamwe n'urukundo",
        "home": "Ahabanza",
        "watch": "Reba Online",
        "about": "Abo Turi",
        "archives": "Ibikomoka",
        "contact": "Twandikire",
        
        // Hero Section
        "welcome": "Murakaza neza mu Kilisiya ya Kaloleni ya ku minsi irindwi",
        "hero-text": "Duhagarire mu gusenga, kwiga, no kukura hamwe muri Yashua",
        "join": "Duhagarire mu gusenga",
        "learn": "Menya Ibindi",
        
        // Upcoming Events
        "upcoming": "Ibizaba",
        "june": "Burimunsi, kuva kuwa gatandatu nigego kugeza kuwa gatandatu nijoro.",
        "july": "15–21 Nissan (Itumba).",
        "event1-title": "Guhumeka, gusubira mu mutima, no kwibuka Irema/Ivuka.",
        "event1-time": "Kuwa gatandatu, saa 3:00 z'umutaga - saa 10:00 z'umugoroba",
        "event1-desc": "Imisengeri y'i sinagogi (Kabbalat Shabbat, Shacharit, gusoma Torati).",
        "event2-title": "Kurya umugati udafite imvutsa (matzah) wenyine",
        "event2-time": "Iminsi irindwi.",
        "event2-desc": "Iki gikorwa gihari iminsi irindwi",
        "event3-title": "Kwiga Torati ijoro ryose (Tikkun Leil Shavuot).",
        "event3-time": "",
        "event3-desc": "Ingingo: Gukira Torati ku Musozi wa Sinai.",
        "view-all": "Reba Ibizaba Byose",
        
        // Watch Online Section
        "watch-title": "Reba Serivisi Zacu ku Internet",
        "watch-text": "Ntushobora kuduhagarira mu mubiri? Reba imyidagaduro yacu ya live cyangwa serivisi zabanje moherewe kuri webure yetu utarakitura uku rubuga.",
        "live": "Sura Iki Gice Cyacu cya YouTube",
        
        // Footer
        "newsletter": "Iyandikishe kugira ugire ingufu n'ibyagezweho",
        "email-placeholder": "Aderesi yawe ya email",
        "quick-links": "Ihuza vya Vuba",
        "contact-us": "Twandikire",
        "rights": "Amasezerano Yose Arindwa"
    }
};

// Language switching functionality
document.addEventListener('DOMContentLoaded', function() {
    const langButtons = document.querySelectorAll('.lang-btn');
    const currentLang = localStorage.getItem('selectedLang') || 'en';
    
    // Set initial language
    setLanguage(currentLang);
    
    // Add click event listeners to language buttons
    langButtons.forEach(button => {
        button.addEventListener('click', function() {
            const selectedLang = this.getAttribute('data-lang');
            setLanguage(selectedLang);
            setActiveLanguageButton(selectedLang);
            localStorage.setItem('selectedLang', selectedLang);
        });
    });
    
    // Set active language button
    function setActiveLanguageButton(lang) {
        langButtons.forEach(button => {
            if (button.getAttribute('data-lang') === lang) {
                button.classList.add('active');
            } else {
                button.classList.remove('active');
            }
        });
    }
    
    // Apply language translations
    function setLanguage(lang) {
        // Update all elements with data-i18n attribute
        const elements = document.querySelectorAll('[data-i18n]');
        elements.forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (translations[lang] && translations[lang][key]) {
                element.textContent = translations[lang][key];
            }
        });
        
        // Update page title based on language
        updatePageTitle(lang);
        
        // Update any placeholder texts
        updatePlaceholders(lang);
        
        // Update any other dynamic content
        updateDynamicContent(lang);
    }
    
    // Update page title based on language
    function updatePageTitle(lang) {
        const titles = {
            'en': 'Kaloleni Seventh Day Church',
            'sw': 'Kanisa la Kaloleni la Siku ya Saba',
            'rw': 'Kilisiya ya Kaloleni ya ku minsi irindwi'
        };
        if (titles[lang]) {
            document.title = titles[lang];
        }
    }
    
    // Update placeholder texts
    function updatePlaceholders(lang) {
        const emailInput = document.querySelector('input[type="email"]');
        if (emailInput && translations[lang] && translations[lang]['email-placeholder']) {
            emailInput.placeholder = translations[lang]['email-placeholder'];
        }
    }
    
    // Update any other dynamic content that might not use data-i18n
    function updateDynamicContent(lang) {
        // Update footer text
        const footerRights = document.querySelector('.footer-bottom p');
        if (footerRights && translations[lang] && translations[lang]['rights']) {
            const year = new Date().getFullYear();
            footerRights.innerHTML = `&copy; ${year} Kaloleni Church of Elohim. ${translations[lang]['rights']}`;
        }
        
        // Update section headings that might not use data-i18n
        const quickLinks = document.querySelector('.footer-column h3:nth-child(2)');
        if (quickLinks && translations[lang] && translations[lang]['quick-links']) {
            quickLinks.textContent = translations[lang]['quick-links'];
        }
        
        const contactUs = document.querySelector('.footer-column h3:nth-child(3)');
        if (contactUs && translations[lang] && translations[lang]['contact-us']) {
            contactUs.textContent = translations[lang]['contact-us'];
        }
        
        const newsletter = document.querySelector('.footer-column h3:nth-child(4)');
        if (newsletter && translations[lang] && translations[lang]['newsletter']) {
            newsletter.textContent = translations[lang]['newsletter'];
        }
        
        const newsletterText = document.querySelector('.footer-column p');
        if (newsletterText && translations[lang] && translations[lang]['newsletter']) {
            newsletterText.textContent = translations[lang]['newsletter'];
        }
    }
    
    // Set initial active button
    setActiveLanguageButton(currentLang);
});

// Mobile menu functionality
document.addEventListener('DOMContentLoaded', function() {
    const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
    const navLinks = document.querySelector('.nav-links');
    
    if (mobileMenuBtn && navLinks) {
        mobileMenuBtn.addEventListener('click', function() {
            navLinks.classList.toggle('active');
            mobileMenuBtn.innerHTML = navLinks.classList.contains('active') 
                ? '<i class="fas fa-times"></i>' 
                : '<i class="fas fa-bars"></i>';
        });
        
        // Close mobile menu when clicking on a link
        const navItems = document.querySelectorAll('.nav-links a');
        navItems.forEach(item => {
            item.addEventListener('click', function() {
                navLinks.classList.remove('active');
                mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
            });
        });
        
        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.main-nav') && navLinks.classList.contains('active')) {
                navLinks.classList.remove('active');
                mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
            }
        });
    }
});

// Smooth scrolling for anchor links
document.addEventListener('DOMContentLoaded', function() {
    const anchorLinks = document.querySelectorAll('a[href^="#"]');
    
    anchorLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            
            const targetId = this.getAttribute('href');
            if (targetId === '#') return;
            
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
                const headerHeight = document.querySelector('.header').offsetHeight;
                const targetPosition = targetElement.offsetTop - headerHeight - 20;
                
                window.scrollTo({
                    top: targetPosition,
                    behavior: 'smooth'
                });
            }
        });
    });
});

// YouTube video functionality
document.addEventListener('DOMContentLoaded', function() {
    // YouTube video IDs for your channel (replace with actual video IDs)
    const sermonVideos = [
        'bMbsiKw9tV4', // Sample video 1
        'dQw4w9WgXcQ', // Sample video 2
        'jNQXAC9IVRw', // Sample video 3
        '9bZkp7q19f0'  // Sample video 4
    ];
    
    const player = document.getElementById('youtubePlayer');
    const placeholder = document.getElementById('videoPlaceholder');
    const switchBtn = document.getElementById('switchVideoBtn');
    
    if (switchBtn) {
        switchBtn.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Get a random video from the array
            const randomIndex = Math.floor(Math.random() * sermonVideos.length);
            const videoId = sermonVideos[randomIndex];
            
            // Update the iframe source
            if (player) {
                player.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
            }
        });
    }
    
    // Optional: Show placeholder if video fails to load
    if (player) {
        player.addEventListener('error', function() {
            player.style.display = 'none';
            if (placeholder) {
                placeholder.style.display = 'flex';
            }
        });
    }
    
    // Optional: Click placeholder to try loading again
    if (placeholder) {
        placeholder.addEventListener('click', function(e) {
            e.preventDefault();
            if (player) {
                player.style.display = 'block';
                placeholder.style.display = 'none';
                player.src = player.src; // Reload the video
            }
        });
    }
});

// Newsletter form handling
document.addEventListener('DOMContentLoaded', function() {
    const newsletterForm = document.querySelector('.newsletter-form');
    
    if (newsletterForm) {
        newsletterForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const emailInput = this.querySelector('input[type="email"]');
            const email = emailInput.value.trim();
            
            if (email && isValidEmail(email)) {
                // Here you would typically send the data to your server
                console.log('Newsletter subscription:', email);
                
                // Show success message
                showNotification('Thank you for subscribing!', 'success');
                emailInput.value = '';
            } else {
                showNotification('Please enter a valid email address', 'error');
            }
        });
    }
    
    function isValidEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
    }
    
    function showNotification(message, type) {
        // Create notification element
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.textContent = message;
        
        // Style the notification
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 5px;
            color: white;
            font-weight: 600;
            z-index: 10000;
            transition: all 0.3s ease;
            transform: translateX(100%);
        `;
        
        if (type === 'success') {
            notification.style.backgroundColor = '#4CAF50';
        } else {
            notification.style.backgroundColor = '#f44336';
        }
        
        // Add to page
        document.body.appendChild(notification);
        
        // Animate in
        setTimeout(() => {
            notification.style.transform = 'translateX(0)';
        }, 100);
        
        // Remove after 3 seconds
        setTimeout(() => {
            notification.style.transform = 'translateX(100%)';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }
});

// Sticky Header and Scroll Reveal Initialization
document.addEventListener('DOMContentLoaded', function() {
    const header = document.querySelector('.header');
    const revealElements = document.querySelectorAll('.reveal');
    
    // Sticky Header Logic
    window.addEventListener('scroll', () => {
        if (window.scrollY > 50) {
            header.classList.add('scrolled');
        } else {
            header.classList.remove('scrolled');
        }
    });

    // Intersection Observer for Scroll Reveal
    const revealObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('active');
            }
        });
    }, { threshold: 0.1 });

    revealElements.forEach(el => revealObserver.observe(el));
    
    // Animate Nav Links on Mobile
    const navLinksList = document.querySelectorAll('.nav-links li');
    navLinksList.forEach((link, index) => {
        link.style.setProperty('--i', index);
    });
});

// Sabbath Service Countdown Timer
function updateCountdown() {
    const countdownContainer = document.getElementById('service-countdown');
    if (!countdownContainer) return;

    const now = new Date();
    
    // Sabbath is Saturday (day 6). Service starts at 9:00 AM.
    // Let's target the next Saturday at 9:00 AM.
    let nextService = new Date();
    nextService.setDate(now.getDate() + (6 + 7 - now.getDay()) % 7);
    nextService.setHours(9, 0, 0, 0);

    // If it's Saturday after 9:00 AM, target next week
    if (now > nextService) {
        nextService.setDate(nextService.getDate() + 7);
    }

    const diff = nextService - now;

    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((diff % (1000 * 60)) / 1000);

    const dEl = document.getElementById('days');
    const hEl = document.getElementById('hours');
    const mEl = document.getElementById('minutes');
    const sEl = document.getElementById('seconds');

    if (dEl) dEl.textContent = String(days).padStart(2, '0');
    if (hEl) hEl.textContent = String(hours).padStart(2, '0');
    if (mEl) mEl.textContent = String(minutes).padStart(2, '0');
    if (sEl) sEl.textContent = String(seconds).padStart(2, '0');
}

// Update countdown every second
setInterval(updateCountdown, 1000);
document.addEventListener('DOMContentLoaded', updateCountdown);
