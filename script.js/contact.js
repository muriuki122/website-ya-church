// Translation data
const translations = {
    en: {
        "site-name": "Kaloleni Church",
        "site-tagline": "Of Elohim",
        "nav-home": "Home",
        "nav-watch": "Watch Online",
        "nav-about": "About Us",
        "nav-archives": "Archives",
        "nav-contact": "Contact",
        "hero-title": "Get In Touch",
        "hero-subtitle": "We are here to pray with you and answer any questions you may have about our ministry.",
        "card-location": "Our Location",
        "card-address": "Kaloleni, Nairobi, Kenya",
        "card-phone": "Call Us",
        "card-email": "Email Us",
        "card-sabbath": "Sabbath Hours",
        "sabbath-time": "Saturday: 9:00 AM - 4:00 PM",
        "form-title": "Send a Message",
        "form-subtitle": "Fill out the form below and we will get back to you as soon as possible.",
        "label-name": "Full Name",
        "label-email": "Email Address",
        "label-subject": "Subject",
        "label-message": "Your Message",
        "opt-general": "General Inquiry",
        "opt-prayer": "Prayer Request",
        "opt-visit": "Planning a Visit",
        "opt-other": "Other",
        "btn-send": "Send Message",
        "map-title": "Find Us in Kaloleni",
        "map-subtitle": "Join us for the Sabbath service this weekend!",
        "btn-directions": "Get Directions",
        "footer-church-name": "Kaloleni Church",
        "footer-desc": "A spiritual home dedicated to worshiping Elohim and serving our community with love and grace.",
        "footer-quick-links": "Quick Links",
        "footer-newsletter": "Newsletter",
        "footer-newsletter-p": "Subscribe to get weekly sermon highlights.",
        "footer-copy": "© 2026 Kaloleni Church of Elohim. All Rights Reserved.",
        "bible-verse": "\"The Lord is near to all who call on him, to all who call on him in truth.\"",
        "bible-ref": "Psalm 145:18"
    },
    sw: {
        "site-name": "Kanisa la Kaloleni",
        "site-tagline": "La Elohim",
        "nav-home": "Mwanzo",
        "nav-watch": "Tazama Mtandaoni",
        "nav-about": "Kuhusu Sisi",
        "nav-archives": "Kumbukumbu",
        "nav-contact": "Wasiliana",
        "hero-title": "Wasiliana Nasi",
        "hero-subtitle": "Tuko hapa kuomba nawe na kujibu maswali yoyote uliyo nayo kuhusu huduma yetu.",
        "card-location": "Mahali Petu",
        "card-address": "Kaloleni, Nairobi, Kenya",
        "card-phone": "Tupigie",
        "card-email": "Tutumie Barua Pepe",
        "card-sabbath": "Saa za Sabato",
        "sabbath-time": "Jumamosi: 9:00 AM - 4:00 PM",
        "form-title": "Tuma Ujumbe",
        "form-subtitle": "Jaza fomu hapa chini na tutakujibu haraka iwezekanavyo.",
        "label-name": "Jina Kamili",
        "label-email": "Barua Pepe",
        "label-subject": "Mada",
        "label-message": "Ujumbe Wako",
        "opt-general": "Uchunguzi wa Jumla",
        "opt-prayer": "Ombi la Maombi",
        "opt-visit": "Kupanga Ziara",
        "opt-other": "Mengineyo",
        "btn-send": "Tuma Ujumbe",
        "map-title": "Tupate Kaloleni",
        "map-subtitle": "Jiunge nasi kwa ibada ya Sabato wiki hii!",
        "btn-directions": "Pata Maelekezo",
        "footer-church-name": "Kanisa la Kaloleni",
        "footer-desc": "Nyumba ya kiroho iliyojitolea kumwabudu Elohim na kuitumikia jamii yetu kwa upendo na neema.",
        "footer-quick-links": "Viungo vya Haraka",
        "footer-newsletter": "Jarida",
        "footer-newsletter-p": "Jiandikishe kupata muhtasari wa mahubiri kila wiki.",
        "footer-copy": "© 2026 Kanisa la Kaloleni la Elohim. Haki Zote Zimehifadhiwa.",
        "bible-verse": "\"Bwana yu karibu na wote wamwitao, wote wamwitao kwa uaminifu.\"",
        "bible-ref": "Zaburi 145:18"
    },
    rw: {
        "site-name": "Itorero rya Kaloleni",
        "site-tagline": "Rya Elohim",
        "nav-home": "Ahabanza",
        "nav-watch": "Reba kuri Interineti",
        "nav-about": "Ibitwerekeye",
        "nav-archives": "Ububikoshingiro",
        "nav-contact": "Twandikire",
        "hero-title": "Twandikire",
        "hero-subtitle": "Turi hano kugira ngo dusengane nawe kandi dusubize ibibazo waba ufite byose ku murimo wacu.",
        "card-location": "Aho Turerekeza",
        "card-address": "Kaloleni, Nairobi, Kenya",
        "card-phone": "Duhamagare",
        "card-email": "Twandikire Ibaruwa",
        "card-sabbath": "Amasaha y'Isabato",
        "sabbath-time": "Ku wa Gatandatu: 9:00 AM - 4:00 PM",
        "form-title": "Ohereza Ubutumwa",
        "form-subtitle": "Uzuza iyi fomire hepfo kandi tuzagusubiza vuba bishoboka.",
        "label-name": "Amazina Hanze",
        "label-email": "Ibaruwa ya Imeje",
        "label-subject": "Icyo Wandikaho",
        "label-message": "Ubutumwa Bwawe",
        "opt-general": "Ibibazo Rusange",
        "opt-prayer": "Gusaba Isengesho",
        "opt-visit": "Kupanga Gusura",
        "opt-other": "Ibindi",
        "btn-send": "Ohereza Ubutumwa",
        "map-title": "Tusange i Kaloleni",
        "map-subtitle": "Fatanya natwe mu materaniro y'Isabato kuri iyi wikendi!",
        "btn-directions": "Shaka Icyerekezo",
        "footer-church-name": "Itorero rya Kaloleni",
        "footer-desc": "Urugo rw'umwuka rwiyeguriye kuramya Elohim no gukorera umuryango wacu mu rukundo n'Ubuntu.",
        "footer-quick-links": "Ihuza Rikoreshwa Cyane",
        "footer-newsletter": "Amakuru",
        "footer-newsletter-p": "Iyandikishe kugira ngo ubone incamake z'inyigisho buri cyumweru.",
        "footer-copy": "© 2026 Itorero rya Kaloleni rya Elohim. Uburenganzira bwose burasubitswe.",
        "bible-verse": "\"Uwiteka ari hafi y’abantu bose bamwambaza, abamwambaza bose mu kuri.\"",
        "bible-ref": "Zaburi 145:18"
    }
};

// DOM Elements
const languageSwitcher = document.querySelector('.language-switcher');
const currentLangDisplay = document.getElementById('current-language');
const langOptions = document.querySelectorAll('.language-dropdown li');
const contactForm = document.getElementById('contact-form');
const hamburger = document.querySelector('.hamburger');
const navLinks = document.querySelector('.nav-links');

// Initialize language
let currentLang = localStorage.getItem('kaloleni_lang') || 'en';

function updatePageContent(lang) {
    document.querySelectorAll('[data-translate]').forEach(el => {
        const key = el.getAttribute('data-translate');
        if (translations[lang][key]) {
            el.innerHTML = translations[lang][key];
        }
    });

    // Update form placeholders
    const nameInput = document.getElementById('name');
    const emailInput = document.getElementById('email');
    const messageInput = document.getElementById('message');

    if (lang === 'sw') {
        nameInput.placeholder = "Ingiza jina lako";
        emailInput.placeholder = "Ingiza barua pepe";
        messageInput.placeholder = "Tunaweza kukusaidia vipi?";
    } else if (lang === 'rw') {
        nameInput.placeholder = "Andika amazina yawe";
        emailInput.placeholder = "Andika ibaruwa yawe";
        messageInput.placeholder = "Twagufasha ute?";
    } else {
        nameInput.placeholder = "Enter your name";
        emailInput.placeholder = "Enter your email";
        messageInput.placeholder = "How can we help you?";
    }

    currentLangDisplay.textContent = lang.toUpperCase();
    localStorage.setItem('kaloleni_lang', lang);
}

// Language selection
langOptions.forEach(opt => {
    opt.addEventListener('click', () => {
        currentLang = opt.getAttribute('data-lang');
        updatePageContent(currentLang);
    });
});

// Mobile Menu
if (hamburger) {
    hamburger.addEventListener('click', () => {
        navLinks.classList.toggle('show');
        hamburger.classList.toggle('active');
    });
}

// Form Submission via Formspree (AJAX)
if (contactForm) {
    contactForm.addEventListener('submit', async (e) => {
        e.preventDefault();

        const btn = contactForm.querySelector('.btn-submit');
        const originalText = btn.innerHTML;

        // Formspree requires headers and the body formatted correctly
        const data = new FormData(contactForm);

        btn.disabled = true;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';

        try {
            const response = await fetch(contactForm.action, {
                method: contactForm.method,
                body: data,
                headers: {
                    'Accept': 'application/json'
                }
            });

            if (response.ok) {
                showNotification(currentLang === 'sw' ? 'Ujumbe umetumwa! Mungu akubariki.' :
                    currentLang === 'rw' ? 'Ubutumwa bwoherejwe! Imana iguhe umugisha.' :
                        'Message sent! God bless you.');
                contactForm.reset();
            } else {
                throw new Error('Submission failed');
            }
        } catch (error) {
            showNotification(currentLang === 'sw' ? 'Hitilafu ilitokea. Jaribu tena.' :
                currentLang === 'rw' ? 'Byanze. Ongera ugerageze.' :
                    'Error occurred. Please try again.');
        } finally {
            btn.disabled = false;
            btn.innerHTML = originalText;
        }
    });
}

function showNotification(message) {
    const toast = document.getElementById('notification-success');
    const msgEl = document.getElementById('notification-message');

    if (toast && msgEl) {
        msgEl.textContent = message;
        toast.classList.add('show');

        setTimeout(() => {
            toast.classList.remove('show');
        }, 4000);
    }
}

// Initial Load
document.addEventListener('DOMContentLoaded', () => {
    updatePageContent(currentLang);
});